## Управление мышью в Python

**Меню**

**Управление мышью в Python**

В этой статье я расскажу как управлять мышью в Python.

Модуль `mouse`  полностью инимирует мышь


Мы будем использовать библиотеку `mouse`. Установка:

```bash
$ pip3 install mouse
```


**Содержание:**

*   Симуляция щелчков мышью
*   Получение позиции мыши
*   Перетаскивание мышью
*   Перемещение мыши
*   Создание обратных вызовов на события мыши
*   Прокрутка вверх и вниз
*   Запись событий мыши и их воспроизведение
*   Игрушечный проект рисования


**Симуляция щелчков мышью**

как имитировать щелчки мышью:

```python
import mouse

# левый щелчок
mouse.click('left')

# правый щелчок
mouse.click('right')

# средний щелчок
mouse.click('middle')

# Oпределить, нажата ли кнопка:
# нажата ли правая кнопка
is_pressed =  mouse.is_pressed("right")
print(is_pressed)
 >>> False
```


*Примечание: рекомендуется выполнять эти операторы по отдельности в интерактивной оболочке Python, 
такой как Jupyter notebook, IPython или просто обычной оболочке Python.*
Функция `mouse.click()` делает то, что следует из ее названия: отправляет щелчок указанной кнопкой. 



**Получить позиции мыши**

```python
mouse.get_position()
>>> (646, 407)
```

Функция `mouse.get_position()` получает текущую позицию курсора мыши на экране. 
При вызове этой функции она возвращает кортеж, содержащий два элемента: x-координату и y-координату 
положения курсора.

Эти координаты обычно представлены в пикселях. Верхний левый угол экрана считается началом координат (0, 0). 
Координата x увеличивается при движении вправо, а координата y увеличивается при движении вниз.

Например, приведенный выше вывод означает, что курсор мыши находится на расстоянии 646 пикселей справа
от левого края основного экрана и на 407 пикселей вниз от верхнего края экрана.

Если у вас несколько экранов, вы можете получить отрицательные значения или значения, превышающие разрешение основного экрана. 
Это происходит потому, что операционная система рассматривает весь набор экранов как одну большую область отображения.


**Перетаскивание мышью**

```python
# перетаскивание из (0, 0) в (100, 100) относительно с продолжительностью 0,1 с
mouse.drag(0, 0, 100, 100, absolute=False, duration=0.1)
```

Установка `absolute` равным `False` при начальных позициях (0, 0) означает, 
что перетаскивание будет происходить из текущей позиции на 100 дальше (по x и y).



**Перемещение мыши**

```python
# перемещение на 100 вправо и на 100 вниз
mouse.move(100, 100, absolute=False, duration=0.2)
```

Это переместит мышь относительно в течение 0,2 секунды. Давайте разберем, что означает каждый параметр в этом вызове функции:

*   `(100, 100)`: это x- и y-координаты, к которым вы хотите переместить курсор мыши. В этом случае оба установлены в 100.
*   `absolute=False`: этот параметр определяет характер перемещения:
    *   Когда `absolute` установлено в `False`, перемещение является относительным. Это означает, что курсор переместится на 100 пикселей вправо (координата x) и на 100 пикселей вниз (координата y) от своего текущего положения.
    *   Если бы `absolute` было установлено в `True`, курсор переместился бы в абсолютную позицию (100, 100) на экране, где (0, 0) обычно является верхним левым углом экрана.
*   `duration=0.2`: этот параметр указывает продолжительность перемещения в секундах. Он установлен на 0,2, что означает, что курсору потребуется 0,2 секунды для завершения перемещения. Это создает плавное, анимированное движение курсора, а не мгновенный скачок. Если бы продолжительность была установлена на 0, перемещение было бы немедленным.


**Создание обратных вызовов на события мыши**

Вы можете создавать обратные вызовы, которые вызываются при возникновении события, 
такого как щелчок мыши:

```python
# создать слушателя при щелчке левой кнопки
mouse.on_click(lambda: print("Нажата левая кнопка."))
# создать слушателя при щелчке правой кнопки
mouse.on_right_click(lambda: print("Нажата правая кнопка."))
```

Приведенный выше код создает простые обратные вызовы при каждом щелчке кнопок мыши; 
здесь мы просто использовали лямбда-функции для демонстрации; 
вы можете использовать любую функцию. Если вы хотите удалить слушателей, вы можете вызвать `unhook_all()`, 
чтобы удалить всех слушателей:

```python
# удалить слушателей, когда захотите
mouse.unhook_all()
```

**Прокрутка вверх и вниз**


```python
# прокрутить вниз
mouse.wheel(-1)
```

Прокрутка вверх:

```python
# прокрутить вверх
mouse.wheel(1)
```

Функция `mouse.wheel()` имитирует прокрутку колеса мыши вниз или вверх. 
Отрицательное значение, такое как -1, указывает на прокрутку вниз на один шаг, 
а положительное значение, такое как `mouse.wheel(5)`, будет указывать на прокрутку вверх на 5 шагов.

**Запись событий мыши и их воспроизведение**

```python
# запись до щелчка правой кнопкой
events = mouse.record()
```

Это запишет все события мыши до тех пор, пока не будет нажата правая кнопка. 
Затем он возвращает список записанных событий:

```python
# воспроизвести эти события
mouse.play(events[:-1])
```

Причина, по которой я установил `events[:-1]` вместо всех событий, заключается в том, 
что я не хочу воспроизводить щелчок правой кнопкой.


**Причина, по которой я установил `events[:-1]` вместо всех событий, заключается в том, что я не хочу воспроизводить щелчок правой кнопкой.**

Давайте создадим игрушечный проект, который рисует квадрат и круг:

```python
import mouse
import math
import time

def draw_square(size):
    # нажать и удерживать левую кнопку мыши
    mouse.press()
    mouse.move(size, 0, absolute=False, duration=0.2)
    mouse.move(0, size, absolute=False, duration=0.2)
    mouse.move(-size, 0, absolute=False, duration=0.2)
    mouse.move(0, -size, absolute=False, duration=0.2)
    # отпустить левую кнопку мыши
    mouse.release()


def draw_circle(radius):
    # нажать и удерживать левую кнопку мыши
    mouse.press()
    # перемещать мышь по кругу
    for i in range(0, 360, 5):
        # преобразовать градусы в радианы
        angle = math.radians(i)
        # рассчитать координаты x и y
        x = radius * math.cos(angle)
        y = radius * math.sin(angle)
        # переместить мышь в рассчитанную позицию
        mouse.move(x, y, absolute=False, duration=0.01)
    # отпустить левую кнопку мыши
    mouse.release()

if __name__ == "__main__":
    # Поместите мышь в начальную точку и затем вызовите
    draw_square(200)
    time.sleep(1)
    draw_circle(100)
```

Не забудьте открыть программу для рисования, такую как Paint, поместить туда мышь и выполнить код, 
и он нарисует квадрат, а затем круг.
